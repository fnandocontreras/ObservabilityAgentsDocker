{
  "AppName": "WeatherForecast",
  "Serilog": {
    "Using": [ "Serilog.Sinks.Console", "Serilog.Sinks.File", "Serilog.Enrichers.Environment", "Serilog.Sinks.OpenTelemetry" ],
    "MinimumLevel": "Debug",
    "WriteTo": [
      { "Name": "Console" },
      {
        "Name": "File",
        "Args": {
          "path": "/logs/otel-agent-test/WeatherForecast.log",
          "formatter": "Serilog.Formatting.Compact.CompactJsonFormatter, Serilog.Formatting.Compact"
        }
      }
    ],
    "Enrich": [ "FromLogContext", "WithMachineName", "WithThreadId", "WithTraceIdAndSpanId" ],
    "Properties": {
      "Application": "WeatherForecast"
    }
  },
  "Logging": {
    "LogLevel": {
      "Default": "Information",
      "Microsoft.AspNetCore": "Warning"
    },
    "NLog": {
      "autoReload": true,
      "extensions": [
        {
          "assembly": "NLog.Web.AspNetCore"
        },
        {
          "assembly": "NLog.DiagnosticSource"
        }
      ],
      "internalLogLevel": "Trace",
      "internalLogFile": "/logs/otel-agent-test/internal-nlog.log",
      "targets": {
        "console": {
          "type": "ColoredConsole",
          "layout": "${logger}|${longdate}|${activity:property=TraceId}|${uppercase:${level}}|url: ${aspnet-request-url} |${message} ${exception:format=ToString,StackTrace}",
          "wordHighlightingRules": [
            {
              "foregroundColor": "Green",
              "regex": "(TRACE|DEBUG|INFO|WARN|ERROR|FATAL)"
            }
          ]
        },
        "file": {
          "type": "File",
          "fileName": "/logs/otel-agent-test/nlog/${shortdate}/${level}-${shortdate}.log",
          "maxArchiveFiles": 1000,
          "archiveNumbering": "Sequence",
          "archiveAboveSize": 1048576,
          "archiveFileName": "/logs/otel-agent-test/archive/${level}-${shortdate}.log",
          "keepFileOpen": true,
          "openFileCacheTimeout": 30,
          "encoding": "utf-8",
          "layout": {
            "type": "JsonLayout",
            "Attributes": [
              {
                "name": "id",
                "layout": "${guid}"
              },
              {
                "name": "date",
                "layout": "${longdate:universalTime=true}"
              },
              {
                "name": "level",
                "layout": "${level:upperCase=true}"
              },
              {
                "name": "application",
                "layout": "WeatherForecast"
              },
              {
                "name": "logger",
                "layout": "${logger}"
              },
              {
                "name": "message",
                "layout": "${message}"
              },
              {
                "name": "machine",
                "layout": "${machinename}"
              },
              {
                "name": "exception",
                "layout": "${exception:format=ToString,StackTrace}"
              },
              {
                "name": "traceId",
                "layout": "${activity:property=TraceId}"
              }
            ]
          }
        }
      },
      "rules": [
        {
          "logger": "*",
          "minLevel": "Information",
          "writeTo": "console",
          "enabled": true
        },
        {
          "logger": "*",
          "minLevel": "Information",
          "writeTo": "file",
          "enabled": true
        }
      ]
    }
  }
}